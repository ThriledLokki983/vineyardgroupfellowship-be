services:
  web:
    build:
      context: .
      dockerfile: Dockerfile
    command: ["./start.sh"]
    container_name: vineyard-group-fellowship-web

    environment:
      DJANGO_ENVIRONMENT: production
      PYTHONUNBUFFERED: "1"
      PYTHONDONTWRITEBYTECODE: "1"
      # plus DB_*/REDIS_* etc (as you already have)

    depends_on:
      pgbouncer:
        condition: service_healthy
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy

    volumes:
      - static_volume:/app/staticfiles
      - media_volume:/app/media
      - logs_volume:/app/logs

volumes:
  static_volume:
  media_volume:
  logs_volume: